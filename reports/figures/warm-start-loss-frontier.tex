% Auto-generated TikZ figure for warm-start loss frontier with per-scale fits
\documentclass[tikz]{standalone}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\begin{document}
\begin{tikzpicture}
  \begin{axis}[
    width=13cm,
    height=8cm,
    xlabel={Pretraining policy loss},
    ylabel={PPO episodes to reach draw rate $\ge 0.97$},
    xmode=log,
    ymode=log,
    xmin=0.03, xmax=3,
    ymin=80, ymax=4000,
    grid=both,
    grid style={dashed, gray!30},
    legend style={at={(0.97,0.03)}, anchor=south east, draw=none, fill=none, font=\normalsize},
    legend cell align=left,
    axis background/.style={fill=white},
    tick align=outside,
  ]
  % scatter points per capacity
  \input{warm-start-loss-frontier-data.tex}
  % per-capacity fits
  \addplot[domain=0.03:3, samples=200, semithick, color=blue!70!black, dashed] {exp(-0.166022829*(ln(x))^2 -0.065211060*ln(x) + 7.568635609)};
  \addlegendentry{Small (451k) fit}
  \addplot[domain=0.03:3, samples=200, semithick, color=orange!85!black, dashdotted] {exp(-0.107978258*(ln(x))^2 +0.066385081*ln(x) + 7.218350135)};
  \addlegendentry{Medium (798k) fit}
  \addplot[domain=0.03:3, samples=200, semithick, color=purple!70!black, dotted] {exp(-0.081396337*(ln(x))^2 +0.136342388*ln(x) + 6.716066562)};
  \addlegendentry{Big (1.79M) fit}
  \end{axis}
\end{tikzpicture}
\end{document}
